# Конфигурация для crypto_signal_bot (ОПТИМИЗИРОВАННАЯ для 15+ сигналов/день)
# Цель: 15+ качественных сигналов в день с закрытием по TP

# --- Таймфреймы ---
TIMEFRAME        = '15m'     # основной ТФ для сигналов (15 минут)
BACKUP_TIMEFRAME = '1h'      # 1ч для подтверждения тренда

# --- EMA периоды (более консервативные для качества) ---
MA_FAST = 16    # увеличено с 12 до 16 для более стабильных сигналов
MA_SLOW = 34    # увеличено с 26 до 34 для лучшего тренда

# --- Лимиты данных ---
LIMIT = 400     # ~4 дня истории на 15м

# --- RSI (более строгие фильтры) ---
RSI_WINDOW = 14
RSI_OVERSOLD = 30    # повышено с 25 до 30 для избежания ложных сигналов
RSI_OVERBOUGHT = 70  # понижено с 75 до 70
RSI_EXTREME_OVERSOLD = 20  # новый фильтр для экстремальных условий
RSI_EXTREME_OVERBOUGHT = 80

# --- ATR (увеличиваем расстояния для TP/SL) ---
ATR_WINDOW = 14
TRAIL_ATR_MULT = 2.0  # увеличено с 1.5

# --- Bollinger Bands ---
BB_WINDOW = 20
BB_STD_DEV = 2.0
BB_SQUEEZE_THRESHOLD = 0.06

# --- MACD ---
MACD_FAST = 12
MACD_SLOW = 26
MACD_SIGNAL = 9

# --- VWAP (более строгие фильтры) ---
USE_VWAP = True
VWAP_DEVIATION_THRESHOLD = 0.012  # уменьшено с 1.5% до 1.2%

# --- Объём (сбалансированные требования) ---
MIN_VOLUME_USDT = 1_000_000  # увеличено с 600К до 1М - только ликвидные пары

# --- Частота сигналов (увеличиваем кулдаун) ---
SIGNAL_COOLDOWN_MINUTES = 60  # увеличено с 45 до 60 для избежания ложных сигналов

# --- Telegram ---
TELEGRAM_TOKEN = '8046529777:AAHV4BfC_cPz7AptR8k6MOKxGQA6FVMm6oM'
TELEGRAM_CHAT_ID = 931346988

# --- Take Profit и Stop Loss (ОПТИМИЗИРОВАННЫЕ ДЛЯ TP С УЧЕТОМ КОМИССИЙ) ---
TP_ATR_MULT = 1.1   # УВЕЛИЧЕНО с 0.7 до 1.1 - покрывает комиссии
SL_ATR_MULT = 2.0   # УМЕНЬШЕНО с 2.2 до 2.0 - баланс
TP_MIN = 0.008      # увеличено с 0.004 до 0.008 - минимум 0.8% для покрытия комиссий
TP_MAX = 0.018      # УВЕЛИЧЕНО с 0.010 до 0.018 - до 1.8% прибыли
SL_MIN = 0.012      # уменьшено с 0.014 до 0.012
SL_MAX = 0.025      # уменьшено с 0.028 до 0.025

# --- Минимальное расстояние между TP и SL (увеличено для покрытия комиссий) ---
MIN_TP_SL_DISTANCE = 0.012  # увеличено с 0.008 - учитываем комиссии

# --- Fee Rate ---
FEE_RATE = 0.0006

# --- СМЯГЧЕННЫЕ фильтры для 15+ сигналов ---
MIN_ADX = 25                # увеличено с 15 до 25 - ТОЛЬКО СИЛЬНЫЕ ТРЕНДЫ
MAX_SPREAD_PCT = 0.006      # уменьшено с 0.010 до 0.006 - только узкие спреды
VOLUME_SPIKE_MULT = 2.0     # увеличено с 1.5 до 2.0 - нужен объемный всплеск
VOLUME_BOOST_THRESHOLD = 2.0  # уменьшено с 2.5 до 2.0
MACD_SIGNAL_WINDOW = 9

# Минимум свечей для анализа
MIN_15M_CANDLES = 80  # уменьшено со 120 до 80

# --- СТРОГИЕ фильтры для высококачественных сигналов ---
MIN_COMPOSITE_SCORE = 15.0   # УВЕЛИЧЕНО с 12.0 до 15.0 - МАКСИМАЛЬНО НАДЕЖНЫЕ СИГНАЛЫ (учитывая нормализацию х0.4)

# --- Пороги триггеров (СТРОГИЕ ДЛЯ НАДЕЖНОСТИ) ---
MIN_TRIGGERS_ACTIVE_HOURS = 0.8   # увеличено с 0.3 до 0.8 - строже
MIN_TRIGGERS_INACTIVE_HOURS = 1.0  # увеличено с 0.4 до 1.0 - еще строже

# --- Адаптивные настройки по времени ---
ACTIVE_HOURS_UTC = [8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21]
ACTIVE_HOURS_MULTIPLIER = 0.90  # более консервативно

# --- Система адаптации к волатильности ---
VOLATILITY_LOOKBACK = 48
HIGH_VOLATILITY_THRESHOLD = 0.025   # более строго
LOW_VOLATILITY_THRESHOLD = 0.015

# При высокой волатильности - мягкие фильтры
HIGH_VOL_ADX_MIN = 20  # снижено с 25 до 20
HIGH_VOL_RSI_EXTREME = 15  # смягчено с 10 до 15

# При низкой волатильности - супер мягкие фильтры  
LOW_VOL_ADX_MIN = 8   # снижено с 10 до 8
LOW_VOL_RSI_RANGE = 8   # увеличено с 5 до 8

# --- Дополнительные строгие фильтры ---
MIN_MOMENTUM = 0.045   # увеличено с 0.035
MAX_BB_WIDTH = 0.08    # уменьшено с 0.10

# --- Фильтры ---
USE_VOLUME_FILTER = True
USE_VOLATILITY_FILTER = True

# --- Стохастический RSI ---
STOCH_RSI_K = 3
STOCH_RSI_D = 3
STOCH_RSI_LENGTH = 14
STOCH_RSI_SMOOTH = 3

# --- Дивергенции ---
USE_DIVERGENCE_DETECTION = True
DIVERGENCE_LOOKBACK = 20

# --- Мультитаймфреймовый анализ ---
USE_MULTI_TIMEFRAME = True
MTF_CONFLUENCE_WEIGHT = 0.8  # увеличено с 0.5

# --- СБАЛАНСИРОВАННАЯ система скоринга (избегаем переоптимизации) ---
WEIGHT_RSI = 1.2       # уменьшено с 2.5 до 1.2
WEIGHT_MACD = 1.5      # уменьшено с 3.0 до 1.5
WEIGHT_BB = 1.1        # уменьшено с 2.2 до 1.1
WEIGHT_VWAP = 1.0      # уменьшено с 2.0 до 1.0
WEIGHT_VOLUME = 1.3    # уменьшено с 2.5 до 1.3
WEIGHT_ADX = 1.8       # уменьшено с 3.5 до 1.8

# --- УСИЛЕННАЯ система скоринга для SHORT (они работают лучше) ---
SHORT_BOOST_MULTIPLIER = 1.3  # уменьшено с 2.2 до 1.3 - умеренный буст
LONG_PENALTY_IN_DOWNTREND = 0.7  # ослаблен штраф с 0.3 до 0.7

# --- Дополнительные фильтры качества ---
MIN_CANDLE_BODY_PCT = 0.4    # увеличено с 0.3
MAX_WICK_TO_BODY_RATIO = 2.5  # уменьшено с 3.0
MIN_VOLUME_MA_RATIO = 1.5     # увеличено с 1.2

# --- Фильтр времени (избегаем низкую активность) ---
AVOID_WEEKEND_SIGNALS = True  # избегаем сигналов в выходные
MIN_MARKET_ACTIVITY_SCORE = 0.7  # увеличено с 0.6

# --- НОВЫЕ ЭКСТРЕМАЛЬНЫЕ ФИЛЬТРЫ ---
MIN_EMA_SEPARATION = 0.008  # минимальное расстояние между EMA (0.8%)
MAX_RSI_VOLATILITY = 15     # максимальная волатильность RSI за 5 свечей
MIN_VOLUME_CONSISTENCY = 0.8  # минимальная консистентность объема
REQUIRE_MACD_HISTOGRAM_CONFIRMATION = True  # требуем подтверждение гистограммы MACD 