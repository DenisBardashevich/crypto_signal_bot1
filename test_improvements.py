#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è –≤–∏–Ω—Ä–µ–π—Ç–∞
—Å 41.6% –¥–æ 60%+
"""

import sys
import os
sys.path.append(os.path.dirname(os.path.abspath(__file__)))

from signal_analyzer import test_new_settings, run_historical_analysis

def main():
    """
    –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π.
    """
    print("üéØ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ò–°–ü–†–ê–í–õ–ï–ù–ù–û–ô –°–ò–°–¢–ï–ú–´ –°–ò–ì–ù–ê–õ–û–í")
    print("–¶–µ–ª—å: –ø–æ–≤—ã—Å–∏—Ç—å –≤–∏–Ω—Ä–µ–π—Ç —Å 41.6% –¥–æ 60%+")
    print("="*80)
    
    try:
        # –¢–µ—Å—Ç–∏—Ä—É–µ–º –Ω–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        print("\n1Ô∏è‚É£ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ù–û–í–´–• –°–¢–†–û–ì–ò–• –ù–ê–°–¢–†–û–ï–ö:")
        results = test_new_settings()
        
        if results:
            print(f"\nüìä –ò–¢–û–ì–û–í–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´:")
            print(f"–í–∏–Ω—Ä–µ–π—Ç: {results['win_rate']:.1f}% (–±—ã–ª–æ 41.6%)")
            print(f"–£–ª—É—á—à–µ–Ω–∏–µ: +{results['improvement']:.1f}%")
            print(f"–°–∏–≥–Ω–∞–ª–æ–≤ –≤ –¥–µ–Ω—å: {results['signals_per_day']:.1f}")
            print(f"–ü—Ä–æ—Ñ–∏—Ç —Ñ–∞–∫—Ç–æ—Ä: {results['profit_factor']:.2f}")
            
            # –û—Ü–µ–Ω–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
            if results['win_rate'] >= 55:
                print("‚úÖ –û–¢–õ–ò–ß–ù–û! –¶–µ–ª—å –¥–æ—Å—Ç–∏–≥–Ω—É—Ç–∞")
            elif results['win_rate'] >= 50:
                print("‚úÖ –•–û–†–û–®–û! –ó–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ")
            elif results['win_rate'] >= 45:
                print("‚ö†Ô∏è –£–î–û–í–õ–ï–¢–í–û–†–ò–¢–ï–õ–¨–ù–û. –ú–æ–∂–Ω–æ –ª—É—á—à–µ")
            else:
                print("‚ùå –ù–ï–£–î–û–í–õ–ï–¢–í–û–†–ò–¢–ï–õ–¨–ù–û. –ù—É–∂–Ω—ã –¥–æ—Ä–∞–±–æ—Ç–∫–∏")
        
        print(f"\n2Ô∏è‚É£ –†–ê–°–®–ò–†–ï–ù–ù–´–ô –ê–ù–ê–õ–ò–ó (7 –¥–Ω–µ–π, 15 —Å–∏–º–≤–æ–ª–æ–≤):")
        run_historical_analysis(hours_back=168, max_symbols=15)
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏: {e}")
        import traceback
        traceback.print_exc()
    
    print(f"\nüéØ –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –î–õ–Ø –î–ê–õ–¨–ù–ï–ô–®–ï–ì–û –£–õ–£–ß–®–ï–ù–ò–Ø:")
    print("1. –ï—Å–ª–∏ –≤–∏–Ω—Ä–µ–π—Ç < 50%: —É–≤–µ–ª–∏—á–∏—Ç—å MIN_COMPOSITE_SCORE –¥–æ 7.0+")
    print("2. –ï—Å–ª–∏ –º–∞–ª–æ —Å–∏–≥–Ω–∞–ª–æ–≤: —Å–ª–µ–≥–∫–∞ —Å–Ω–∏–∑–∏—Ç—å MIN_ADX –∏–ª–∏ MIN_TRIGGERS")
    print("3. –ï—Å–ª–∏ –±–æ–ª—å—à–∏–µ —É–±—ã—Ç–∫–∏: —É–≤–µ–ª–∏—á–∏—Ç—å SL_ATR_MULT –¥–æ 3.5")
    print("4. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ 24-48 —á–∞—Å–æ–≤")
    print("="*80)

if __name__ == "__main__":
    main() 